<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon">
    <title>Hotel Calendar</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="css/allocate.css">
    <!--<script src="https://unpkg.com/@popperjs/core@2"></script>-->
    <div id="controls">
      <label for="dayInput">Number of days to allocate:</label>
      <input type="number" id="dayInput" name="dayInput" value="10" min="0" step="1" />

      <button id="allocateButtonLeastDiff">
        <span class="color-indicator least-diff"></span>
        Allocate least difference
      </button>
    
      <button id="allocateButtonStayDuration">
        <span class="color-indicator duration"></span>
        Allocate stay duration
      </button>
    
      <button id="allocateButtonRandom">
        <span class="color-indicator random"></span>
        Allocate random
      </button>

      <label for="bookingsInput">Amount of bookings:</label>
      <input type="number" id="bookingsInput" name="bookingsInput" value="500" min="0" step="1" />

      <button id="batchButton_id">
        <span class="color-indicator batch"></span>
        Generate bookings
      </button>
     
      <button id="resetMatrix">
        <span class="color-indicator reset"></span>
        Reset matrix
      </button>

      <button id="resetEverything">
        <span class="color-indicator reset"></span>
        Reset everything
      </button>
    </div>
    <div id="evaluationOutput" style="margin-top: 1rem; padding: 1rem; border: 1px solid #ccc; border-radius: 8px;">
      <h3>Evaluation Summary</h3>
      <ul>
        <li><strong>Occupancy Score before preference optimization:</strong> <span id="wastedSpace">-</span></li>
        <li><strong>Occupancy Score after preference optimization:</strong> <span id="wastedSpace">-</span></li>
        <li><strong>Average Preference Score:</strong> <span id="avgPrefScore">-</span></li>
        <li><strong>Assigned Bookings:</strong> <span id="assignedCount">-</span></li>
        <li><strong>Failed Bookings:</strong> <span id="failedCount">-</span></li>
        <li><strong>Ratio of filled slots:</strong> <span id="zeroCells">-</span></li>
      </ul>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar-scheduler@6.1.15/index.global.min.js"></script>
    <script src="js/calendar.js"></script>
  </head>
  <body>
    <div id="calendar"></div>
  </body>
  <script type="module">
    // Import needed for allocate (use of calendar in HTML file).
    import { allocateLeastDiff, allocateStayDuration, allocateRandom, generateBatches, resetMatrix, resetEverything } from './js/allocation.js';

    /* Event listeners and handlers for the buttons */
    // Generate batch of bookings button.
    let batchElem = document.querySelector("#batchButton_id");
    batchElem.addEventListener("click", generateBatches);

    // Reset matrix button.
    let resetMatrixElem = document.querySelector("#resetMatrix");
    resetMatrixElem.addEventListener("click", resetMatrix);
    
    // Reset everything button.
    let resetAllElem = document.querySelector("#resetEverything");
    resetAllElem.addEventListener("click", resetEverything);

    // Allocate random button - no sort.
    let randomElem = document.querySelector("#allocateButtonRandom");
    randomElem.addEventListener("click", allocateRandom);

    // Allocate and sort by stay duration and best fit.
    let allocateLDElem = document.querySelector("#allocateButtonLeastDiff");
    allocateLDElem.addEventListener("click", allocateLeastDiff);

    // Allocate and sort by stay duration only.
    let allocateSDElem = document.querySelector("#allocateButtonStayDuration");
    allocateSDElem.addEventListener("click", allocateStayDuration);

  </script>
</html>